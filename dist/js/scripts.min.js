"use strict";
let pokemonRepository = (function () {
  let e = [];
  function t() {
    return e;
  }
  function n(e) {
    o(e).then(function () {
      var t;
      let n, i, o, a, r, l, s;
      (t = e),
        (n = $(".modal-body")),
        (i = $(".modal-title")),
        i.empty(),
        n.empty(),
        (o = $("<h1>" + t.name + "</h1>")),
        (a = $('<img class="modal-img">')),
        a.attr("src", t.imageUrl),
        (r = $("<span>Types : " + t.types + "</span>")),
        (l = $("<p>Height : " + t.height + "m </p>")),
        (s = $("<p>Weight : " + t.weight + " kg </p>")),
        i.append(o),
        n.append(a),
        n.append(r),
        n.append(l),
        n.append(s);
    });
  }
  function i(t) {
    "object" == typeof t && "name" in t && "detailsUrl" in t
      ? e.push(t)
      : console.log("Please check the inputs");
  }
  function o(e) {
    return fetch(e.detailsUrl)
      .then(function (e) {
        return e.json();
      })
      .then(function (t) {
        (e.imageUrl = t.sprites.other["official-artwork"].front_default),
          (e.weight = t.weight),
          (e.height = t.height),
          (e.types = []);
        for (var n = 0; n < t.types.length; n++)
          e.types.push(t.types[n].type.name);
      })
      .catch(function (e) {
        console.error(e);
      });
  }
  return (
    document.addEventListener("DOMContentLoaded", function () {
      let t = document.getElementById("form1"),
        n = document.getElementById("results");
      t.addEventListener("keyup", function () {
        var i;
        let o = t.value.toLowerCase(),
          a = e.filter((e) => e.name.toLowerCase().includes(o));
        (i = a),
          (document.getElementById("results").innerHTML = ""),
          i.forEach((e) => {
            let t = document.createElement("div");
            (t.textContent = `${e.name} (${e.type})`), n.appendChild(t);
          });
      });
    }),
    {
      getAll: t,
      add: i,
      addListItem: function e(t) {
        let i = document.querySelector(".list-group"),
          o = document.createElement("li");
        o.classList.add("list__item", "list-group-item");
        let a = document.createElement("button");
        a.classList.add("pokemon-block", "btn", "btn-primary"),
          a.setAttribute("data-toggle", "modal"),
          a.setAttribute("data-target", "#pokemonModal");
        let r = document.createElement("div");
        (r.innerText = t.name),
          a.addEventListener("click", function () {
            n(t);
          });
        let l = document.createElement("img");
        l.classList.add("pokemon-block__image"),
          (l.src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/versions/generation-v/black-white/animated/${t.id}.gif`),
          a.setAttribute("id", t.id),
          a.appendChild(r),
          o.appendChild(a),
          i.appendChild(o),
          a.appendChild(l);
      },
      loadList: function e() {
        return fetch("https://pokeapi.co/api/v2/pokemon/?limit=50")
          .then(function (e) {
            return e.json();
          })
          .then(function (e) {
            e.results.forEach(function (e, t) {
              i({
                id: t + 1,
                name: e.name,
                imageUrl: e.imageUrl,
                detailsUrl: e.url,
              });
            });
          })
          .catch(function (e) {
            console.error(e);
          });
      },
      loadDetails: o,
      showDetails: n,
    }
  );
})();
pokemonRepository.loadList().then(function () {
  pokemonRepository.getAll().forEach(function (e) {
    pokemonRepository.addListItem(e);
  });
});
